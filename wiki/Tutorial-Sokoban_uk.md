# Навчання: Створення головоломки Сокобан

> **Виберіть вашу мову / Choisissez votre langue / Wählen Sie Ihre Sprache:**
>
> [English](Tutorial-Sokoban) | [Français](Tutorial-Sokoban_fr) | [Deutsch](Tutorial-Sokoban_de) | [Italiano](Tutorial-Sokoban_it) | [Español](Tutorial-Sokoban_es) | [Português](Tutorial-Sokoban_pt) | [Slovenščina](Tutorial-Sokoban_sl) | [Українська](Tutorial-Sokoban_uk) | [Русский](Tutorial-Sokoban_ru)

---

## Вступ

У цьому навчанні ви створите головоломку **Сокобан** — класичну головоломку з штовханням ящиків, де гравець повинен штовхати всі ящики на цільові місця. Сокобан (у японській мові означає "охоронець складу") ідеально підходить для вивчення рухів на сітці та логіки головоломок.

**Що ви навчитесь:**
- Рух на основі сітки (рух фіксованими кроками)
- Механіка штовхання для переміщення предметів
- Виявлення зіткнень з різними типами об'єктів
- Виявлення умови перемоги
- Дизайн рівнів для головоломок

**Складність:** Початківець
**Шаблон:** Шаблон для початківців

---

## Крок 1: Розуміння гри

### Правила гри
1. Гравець може рухатися вгору, вниз, вліво або вправо
2. Гравець може штовхати ящики (але не тягти їх)
3. Одночасно можна штовхати тільки один ящик
4. Ящики не можна штовхати крізь стіни або інші ящики
5. Рівень завершений, коли всі ящики знаходяться на цільових місцях

### Що нам потрібно

| Елемент | Призначення |
|---------|---------|
| **Гравець** | Охоронець складу, яким ви керуєте |
| **Ящик** | Коробки, які штовхає гравець |
| **Стіна** | Тверді перешкоди, що блокують рух |
| **Мета** | Цільові місця, де мають бути розташовані ящики |
| **Підлога** | Прохідний грунт (дополнительно для зовнішнього вигляду) |

---

## Крок 2: Створення спрайтів

Усі спрайти мають бути одного розміру (32x32 пікселі добре підходять) для створення правильної сітки.

### 2.1 Спрайт гравця

1. У **Дереві ресурсів** натисніть правою кнопкою миші на **Спрайти** і виберіть **Створити спрайт**
2. Назвіть його `spr_player`
3. Клацніть **Редагувати спрайт**, щоб відкрити редактор спрайтів
4. Намалюйте простого персонажа (людину або робота)
5. Використовуйте яскраву колір, наприклад синій або зелений
6. Розмір: 32x32 пікселі
7. Клацніть **OK**, щоб зберегти

### 2.2 Спрайт ящика

1. Створіть новий спрайт із назвою `spr_crate`
2. Намалюйте дерев'яний ящик або форму коробки
3. Використовуйте коричневі або помаранчеві кольори
4. Розмір: 32x32 пікселі

### 2.3 Спрайт ящика на цілі

1. Створіть новий спрайт із назвою `spr_crate_ok`
2. Намалюйте той же ящик, але іншого кольору (зеленого), щоб показати, що він правильно розташований
3. Розмір: 32x32 пікселі

### 2.4 Спрайт стіни

1. Створіть новий спрайт із назвою `spr_wall`
2. Намалюйте тверду цеглу або кам'яний рисунок
3. Використовуйте сірі або темні кольори
4. Розмір: 32x32 пікселі

### 2.5 Спрайт цілі

1. Створіть новий спрайт із назвою `spr_target`
2. Намалюйте позначку X або показник мети
3. Використовуйте яскравий колір, наприклад червоний або жовтий
4. Розмір: 32x32 пікселі

### 2.6 Спрайт підлоги (Дополнительно)

1. Створіть новий спрайт із назвою `spr_floor`
2. Намалюйте простий малюнок підлогового плитки
3. Використовуйте нейтральний колір
4. Розмір: 32x32 пікселі

---

## Крок 3: Створення об'єкту стіни

Стіна — це найпростіший об'єкт, який просто блокує рух.

1. Натисніть правою кнопкою миші на **Об'єкти** і виберіть **Створити об'єкт**
2. Назвіть його `obj_wall`
3. Встановіть спрайт на `spr_wall`
4. **Встановіть прапорець "Solid"**
5. Події не потрібні

---

## Крок 4: Створення об'єкту цілі

Цілі позначають місця, де мають бути розташовані ящики.

1. Створіть новий об'єкт із назвою `obj_target`
2. Встановіть спрайт на `spr_target`
3. Події не потрібні — це просто маркер
4. Залиште "Solid" невідзначеним (гравець і ящики можуть знаходитися на ньому)

---

## Крок 5: Створення об'єкту ящика

Ящик штовхається гравцем і змінює зовнішній вигляд, коли знаходиться на цілі.

1. Створіть новий об'єкт із назвою `obj_crate`
2. Встановіть спрайт на `spr_crate`
3. **Встановіть прапорець "Solid"**

**Подія: Step**
1. Додати подію → Step → Step
2. Додати дію: **Control** → **Test Variable**
   - Variable: `place_meeting(x, y, obj_target)`
   - Value: `1`
   - Operation: Equal to
3. Додати дію: **Main1** → **Change Sprite**
   - Sprite: `spr_crate_ok`
   - Subimage: `0`
   - Speed: `1`
4. Додати дію: **Control** → **Else**
5. Додати дію: **Main1** → **Change Sprite**
   - Sprite: `spr_crate`
   - Subimage: `0`
   - Speed: `1`

Це робить ящик зеленим, коли він знаходиться на цільовому місці.

---

## Крок 6: Створення об'єкту гравця

Гравець — це найбільш складний об'єкт з рухом на сітці і механікою штовхання.

1. Створіть новий об'єкт із назвою `obj_player`
2. Встановіть спрайт на `spr_player`

### 6.1 Рух вправо

**Подія: Keyboard Press Right Arrow**
1. Додати подію → Keyboard → Press Right

Спочатку перевірте, чи немає стіни на шляху:
2. Додати дію: **Control** → **Test Collision**
   - Object: `obj_wall`
   - X: `32`
   - Y: `0`
   - Check: NOT (означає "якщо немає стіни")

Якщо немає стіни, перевірте, чи є ящик:
3. Додати дію: **Control** → **Test Collision**
   - Object: `obj_crate`
   - X: `32`
   - Y: `0`

Якщо є ящик, нам потрібно перевірити, чи можемо ми його штовхати:
4. Додати дію: **Control** → **Test Collision** (для пункту призначення ящика)
   - Object: `obj_wall`
   - X: `64`
   - Y: `0`
   - Check: NOT

5. Додати дію: **Control** → **Test Collision**
   - Object: `obj_crate`
   - X: `64`
   - Y: `0`
   - Check: NOT

Якщо обидві перевірки пройдені, штовхніть ящик:
6. Додати дію: **Control** → **Code Block**
```
var crate = instance_place(x + 32, y, obj_crate);
if (crate != noone) {
    crate.x += 32;
}
```

Тепер рухніть гравця:
7. Додати дію: **Move** → **Jump to Position**
   - X: `32`
   - Y: `0`
   - Check "Relative"

### 6.2 Рух вліво

**Подія: Keyboard Press Left Arrow**
Дотримуйтесь того ж шаблону, що й рух вправо, але використовуйте:
- X offset: `-32` для перевірки стіни/ящика
- X offset: `-64` для перевірки, чи можна штовхати ящик
- Move crate by `-32`
- Jump to position X: `-32`

### 6.3 Рух вгору

**Подія: Keyboard Press Up Arrow**
Дотримуйтесь того ж шаблону, але використовуйте значення Y:
- Y offset: `-32` для перевірки
- Y offset: `-64` для пункту призначення ящика
- Move crate by Y: `-32`
- Jump to position Y: `-32`

### 6.4 Рух вниз

**Подія: Keyboard Press Down Arrow**
Використовуйте:
- Y offset: `32` для перевірки
- Y offset: `64` для пункту призначення ящика
- Move crate by Y: `32`
- Jump to position Y: `32`

---

## Крок 7: Спрощений рух гравця (Альтернатива)

Якщо наведений вище підхід на основі блоків здається складним, ось простіший підхід на основі коду для кожного напрямку:

**Подія: Keyboard Press Right Arrow**
Додати дію: **Control** → **Execute Code**
```
// Check if we can move right
if (!place_meeting(x + 32, y, obj_wall)) {
    // Check if there's a crate
    var crate = instance_place(x + 32, y, obj_crate);
    if (crate != noone) {
        // There's a crate - can we push it?
        if (!place_meeting(x + 64, y, obj_wall) && !place_meeting(x + 64, y, obj_crate)) {
            crate.x += 32;
            x += 32;
        }
    } else {
        // No crate, just move
        x += 32;
    }
}
```

Повторіть для інших напрямків з відповідними змінами координат.

---

## Крок 8: Створення перевірки умови перемоги

Нам потрібен об'єкт для перевірки, чи всі ящики знаходяться на цілях.

1. Створіть новий об'єкт із назвою `obj_game_controller`
2. Спрайт не потрібен

**Подія: Create**
1. Додати подію → Create
2. Додати дію: **Score** → **Set Variable**
   - Variable: `global.total_targets`
   - Value: `0`
3. Додати дію: **Control** → **Execute Code**
```
// Count how many targets exist
global.total_targets = instance_number(obj_target);
```

**Подія: Step**
1. Додати подію → Step → Step
2. Додати дію: **Control** → **Execute Code**
```
// Count crates that are on targets
var crates_on_targets = 0;
with (obj_crate) {
    if (place_meeting(x, y, obj_target)) {
        crates_on_targets += 1;
    }
}

// Check if all targets have crates
if (crates_on_targets >= global.total_targets && global.total_targets > 0) {
    // Level complete!
    show_message("Level Complete!");
    room_restart();
}
```

**Подія: Draw**
1. Додати подію → Draw
2. Додати дію: **Draw** → **Draw Text**
   - Text: `Sokoban - Push all crates to targets!`
   - X: `10`
   - Y: `10`

---

## Крок 9: Проектування вашого рівня

1. Натисніть правою кнопкою миші на **Rooms** і виберіть **Create Room**
2. Назвіть його `room_level1`
3. Встановіть розмір кімнати на кратну 32 (наприклад, 640x480)
4. Увімкніть "Snap to Grid" і встановіть сітку на 32x32

### Розміщення об'єктів

Розробіть свій рівень, дотримуючись цих рекомендацій:

1. **Обведіть рівень стінами** — створіть межу
2. **Додайте внутрішні стіни** — створіть структуру головоломки
3. **Розмістіть цілі** — де мають бути розташовані ящики
4. **Розмістіть ящики** — такої ж кількості, як цілі!
5. **Розмістіть гравця** — стартова позиція
6. **Розмістіть контролер гри** — будь-де (він невидимий)

### Приклад розташування рівня

```
W W W W W W W W W W
W . . . . . . . . W
W . P . . . C . . W
W . . W W . . . . W
W . . W T . . C . W
W . . . . . W W . W
W . T . . . . . . W
W . . . . . . . . W
W W W W W W W W W W

W = Wall
P = Player
C = Crate
T = Target
. = Empty floor
```

**Важливо:** Завжди майте таку ж кількість ящиків і цілей!

---

## Крок 10: Тестуйте вашу гру!

1. Клацніть **Run** або натисніть **F5** для тестування
2. Використовуйте клавіші зі стрілками для переміщення
3. Штовхайте ящики на червоні X цілі
4. Коли всі ящики на цілях, ви перемагаєте!

---

## Покращення (Дополнительно)

### Додати лічильник ходів

У `obj_game_controller`:

**Подія: Create** - Додайте:
```
global.moves = 0;
```

У `obj_player`, після кожного успішного ходу, додайте:
```
global.moves += 1;
```

У `obj_game_controller` **Подія: Draw** - Додайте:
```
draw_text(10, 30, "Moves: " + string(global.moves));
```

### Додати функцію скасування

Збережіть попередні позиції та дозвольте натиснути Z для скасування останнього ходу.

### Додати кілька рівнів

Створіть більше кімнат (`room_level2`, `room_level3` тощо) і використовуйте:
```
room_goto_next();
```
замість `room_restart()` при завершенні рівня.

### Додати звукові ефекти

Додайте звуки для:
- Руху гравця
- Штовхання ящика
- Приземлення ящика на ціль
- Завершення рівня

---

## Усунення неполадок

| Проблема | Рішення |
|---------|----------|
| Гравець проходить крізь стіни | Перевірте, що у `obj_wall` встановлений прапорець "Solid" |
| Ящик не змінює колір | Перевірте, що подія Step правильно перевіряє `place_meeting` |
| Можна штовхати ящик крізь стіну | Перевірте виявлення зіткнення перед переміщенням ящика |
| Повідомлення про перемогу з'являється відразу | Переконайтесь, що цілі розміщені окремо від ящиків |
| Гравець рухається на кілька квадратів | Використовуйте подію Keyboard Press, а не подію Keyboard |

---

## Що ви навчилися

Вітаємо! Ви створили повну головоломку Сокобан! Ви навчилися:

- **Рух на основі сітки** — переміщення фіксованими кроками по 32 пікселі
- **Механіка штовхання** — виявлення та переміщення об'єктів, які штовхає гравець
- **Складна логіка зіткнення** — перевірка кількох умов перед дозволом руху
- **Зміни стану** — зміна спрайту на основі положення об'єкту
- **Умови перемоги** — перевірка, коли всі цілі досягнені
- **Дизайн рівня** — створення розв'язуваних макетів головоломок

---

## Виклик: Розробіть свої власні рівні!

Справжня увага Сокобану полягає у проектуванні головоломок. Спробуйте створити рівні, які:
- Починаються легко і поступово ускладнюються
- Вимагають передбачення
- Мають тільки одне рішення
- Ефективно використовують мінімальний простір

Пам'ятайте: хороша головоломка Сокобан повинна бути складною, але справедливою!

---

## Дивіться також

- [Навчання](Tutorials_uk) — Більше навчальних матеріалів з гри
- [Шаблон для початківців](Beginner-Preset_uk) — Огляд функцій для початківців
- [Навчання: Pong](Tutorial-Pong_uk) — Створіть гру для двох гравців
- [Навчання: Breakout](Tutorial-Breakout_uk) — Створіть гру з розбиванням цегли
- [Довідка подій](Event-Reference_uk) — Повна документація подій
